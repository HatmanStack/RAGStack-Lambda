<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AmplifyChat Web Component Test</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      background: #f5f5f5;
    }
    .test-container {
      border: 1px solid #ddd;
      padding: 20px;
      margin: 20px 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      border-bottom: 3px solid #007bff;
      padding-bottom: 10px;
    }
    h2 {
      margin-top: 0;
      color: #555;
      font-size: 1.2em;
    }
    .test-info {
      background: #e7f3ff;
      border-left: 4px solid #007bff;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 4px;
    }
    .test-info code {
      background: #fff;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
  </style>
</head>
<body>
  <h1>AmplifyChat Web Component Tests</h1>

  <div class="test-info">
    <strong>Test Status:</strong> Web component bundle loaded via script tag<br>
    <strong>Bundle:</strong> <code>dist/wc.js</code> (121 KB gzipped)<br>
    <strong>Config:</strong> Mock Amplify configuration embedded<br>
    <strong>Open DevTools Console:</strong> Check for component registration and errors
  </div>

  <div class="test-container">
    <h2>Test 1: Default Light Theme</h2>
    <amplify-chat
      conversation-id="test-light"
      header-text="Light Theme Chat"
      header-subtitle="Testing default light theme"
    ></amplify-chat>
  </div>

  <div class="test-container">
    <h2>Test 2: Dark Theme</h2>
    <amplify-chat
      conversation-id="test-dark"
      header-text="Dark Theme Chat"
      header-subtitle="Testing dark theme preset"
      theme-preset="dark"
    ></amplify-chat>
  </div>

  <div class="test-container">
    <h2>Test 3: Custom Theme with Color Override</h2>
    <amplify-chat
      conversation-id="test-custom"
      header-text="Custom Purple Chat"
      header-subtitle="Testing theme overrides"
      theme-overrides='{"primaryColor": "#9c27b0"}'
    ></amplify-chat>
  </div>

  <div class="test-container">
    <h2>Test 4: Custom Input Placeholder</h2>
    <amplify-chat
      conversation-id="test-placeholder"
      header-text="Custom Placeholder"
      header-subtitle="Testing input-placeholder attribute"
      input-placeholder="Type your custom question here..."
    ></amplify-chat>
  </div>

  <!-- Load the web component bundle -->
  <script src="dist/wc.js"></script>

  <!-- Test script -->
  <script>
    console.log('=== AmplifyChat Web Component Test Page ===');

    // Check if custom element is registered
    const isRegistered = customElements.get('amplify-chat');
    console.log('Custom element registered:', !!isRegistered);

    if (!isRegistered) {
      console.error('‚ùå amplify-chat custom element not registered!');
      document.body.insertAdjacentHTML('afterbegin',
        '<div style="background: #fee; border: 2px solid #c00; padding: 20px; margin: 20px 0;">' +
        '<h3>‚ö†Ô∏è Error: Web component not loaded</h3>' +
        '<p>The amplify-chat custom element is not registered. Check console for errors.</p>' +
        '</div>'
      );
    } else {
      console.log('‚úÖ amplify-chat custom element registered successfully');
    }

    // Wait for components to mount
    setTimeout(() => {
      const chatElements = document.querySelectorAll('amplify-chat');
      console.log(`Found ${chatElements.length} chat instances on page`);

      chatElements.forEach((chat, index) => {
        console.log(`Chat ${index + 1}:`, {
          conversationId: chat.getAttribute('conversation-id'),
          headerText: chat.getAttribute('header-text'),
          themePreset: chat.getAttribute('theme-preset') || 'light'
        });
      });

      // Test programmatic API
      const firstChat = chatElements[0];
      if (firstChat && firstChat.getConversationId) {
        console.log('Testing programmatic API...');
        console.log('Current conversation ID:', firstChat.getConversationId());

        // Test setting conversation ID
        firstChat.setConversationId('programmatically-set-id');
        console.log('New conversation ID:', firstChat.getConversationId());

        // Reset it
        firstChat.setConversationId('test-light');
      }

      // Test attribute changes
      console.log('Testing dynamic attribute changes...');
      setTimeout(() => {
        const darkChat = chatElements[1];
        if (darkChat) {
          console.log('Changing theme from dark to light...');
          darkChat.setAttribute('theme-preset', 'light');
        }
      }, 2000);
    }, 1000);

    // Listen for custom events
    document.addEventListener('amplify-chat:send-message', (event) => {
      console.log('üöÄ Message sent:', event.detail);
    });

    document.addEventListener('amplify-chat:response-received', (event) => {
      console.log('üì® Response received:', event.detail);
    });

    console.log('Test page loaded. Try:');
    console.log('1. Send messages in each chat instance');
    console.log('2. Check if themes apply correctly');
    console.log('3. Verify custom placeholder appears in Test 4');
    console.log('4. Watch for custom events in console');
  </script>
</body>
</html>
