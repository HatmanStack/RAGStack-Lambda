<!DOCTYPE html>
<html>
<head>
    <title>Check CDN Format</title>
</head>
<body>
    <h1>Checking CDN Format</h1>
    <pre id="output"></pre>
    <pre id="code"></pre>

    <script>
        const output = document.getElementById('output');
        const codeEl = document.getElementById('code');

        output.textContent = 'Fetching from CDN...\n';

        fetch('https://d3w5cdfl4m6ati.cloudfront.net/amplify-chat.js')
            .then(response => {
                output.textContent += `Status: ${response.status}\n`;
                output.textContent += `Headers:\n`;
                response.headers.forEach((value, key) => {
                    output.textContent += `  ${key}: ${value}\n`;
                });
                return response.text();
            })
            .then(code => {
                output.textContent += `\nCode length: ${code.length} bytes\n\n`;

                // Check for UMD vs IIFE patterns
                const isUMD = code.includes('typeof exports') && code.includes('typeof define');
                const isIIFE = code.match(/^\s*\(function\s*\(/) || code.match(/^\s*\(\(\)\s*=>/);
                const hasCustomElements = code.includes('customElements.define');
                const hasAmplifyConfig = code.includes('Amplify.configure');

                output.textContent += 'Format Analysis:\n';
                output.textContent += `  UMD pattern detected: ${isUMD ? '❌ YES (wrong!)' : '✅ NO'}\n`;
                output.textContent += `  IIFE pattern detected: ${isIIFE ? '✅ YES' : '❌ NO'}\n`;
                output.textContent += `  Has customElements.define: ${hasCustomElements ? '✅ YES' : '❌ NO'}\n`;
                output.textContent += `  Has Amplify.configure: ${hasAmplifyConfig ? '✅ YES' : '❌ NO'}\n`;

                // Show first 50 lines
                output.textContent += `\nFirst 50 lines of code:\n`;
                codeEl.textContent = code.split('\n').slice(0, 50).join('\n');
            })
            .catch(error => {
                output.textContent += `\n❌ Error: ${error.message}\n`;
            });
    </script>
</body>
</html>
